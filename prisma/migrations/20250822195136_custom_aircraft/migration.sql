CREATE TABLE "public"."aircraft"
(
    "id"   SERIAL NOT NULL,
    "icao" TEXT,
    "name" TEXT   NOT NULL,

    CONSTRAINT "aircraft_pkey" PRIMARY KEY ("id")
);

INSERT INTO "public"."aircraft" (icao, name)
VALUES ('A109', 'Agusta A109'),
       ('A30B', 'Airbus A300-100/200'),
       ('A306', 'Airbus A300-600'),
       ('BCS1', 'Airbus A220-100'),
       ('BCS3', 'Airbus A220-300'),
       ('A310', 'Airbus A310'),
       ('A318', 'Airbus A318'),
       ('A319', 'Airbus A319'),
       ('A19N', 'Airbus A319'),
       ('A320', 'Airbus A320'),
       ('A20N', 'Airbus A320neo'),
       ('A321', 'Airbus A321'),
       ('A21N', 'Airbus A321neo'),
       ('A332', 'Airbus A330-200'),
       ('A333', 'Airbus A330-300'),
       ('A340', 'Airbus A340'),
       ('A342', 'Airbus A340-200'),
       ('A343', 'Airbus A340-300'),
       ('A345', 'Airbus A340-500'),
       ('A346', 'Airbus A340-600'),
       ('A359', 'Airbus A350-900'),
       ('A35K', 'Airbus A350-1000'),
       ('A388', 'Airbus A380-800'),
       ('AT43', 'ATR-42-300'),
       ('AT44', 'ATR-42-400'),
       ('AT45', 'ATR-42-500'),
       ('AT46', 'ATR-42-600'),
       ('AT72', 'ATR-72-200'),
       ('AT73', 'ATR-72-210'),
       ('AT75', 'ATR-72-500'),
       ('AN12', 'Antonov AN-12'),
       ('AN22', 'Antonov AN-22'),
       ('AN24', 'Antonov AN-24'),
       ('AN26', 'Antonov AN-26'),
       ('AN28', 'Antonov AN-28'),
       ('AN30', 'Antonov AN-30'),
       ('AN32', 'Antonov AN-32'),
       ('AN38', 'Antonov AN-38'),
       ('AN72', 'Antonov AN-72'),
       ('A124', 'Antonov AN-124'),
       ('A140', 'Antonov AN-140'),
       ('A148', 'Antonov AN-148'),
       ('A225', 'Antonov AN-225'),
       ('RJ70', 'Avro RJ70'),
       ('RJ85', 'Avro RJ85'),
       ('RJ1H', 'Avro RJ100'),
       ('LOAD', 'Ayres LM-200 Loadmaster'),
       ('B461', 'BAe-146-100'),
       ('B462', 'BAe-146-200'),
       ('B463', 'BAe-146-300'),
       ('BE58', 'Beechcraft Baron'),
       ('BE9L', 'Beechcraft King Air 90'),
       ('BE20', 'Beechcraft King Air 200'),
       ('BE30', 'Beechcraft King Air 350'),
       ('BE35', 'Beechcraft Super King Air 350'),
       ('BE19', 'Beechcraft 1900'),
       ('DH8A', 'Bombardier DHC-8-100 Dash 8'),
       ('DH8B', 'Bombardier DHC-8-200 Dash 8'),
       ('DH8C', 'Bombardier DHC-8-300 Dash 8'),
       ('DH8D', 'Bombardier DHC-8-400 Dash 8'),
       ('B701', 'Boeing 707-100'),
       ('B703', 'Boeing 707-300'),
       ('B712', 'Boeing 717-200'),
       ('B721', 'Boeing 727-100'),
       ('B722', 'Boeing 727-200'),
       ('B732', 'Boeing 737-200'),
       ('B733', 'Boeing 737-300'),
       ('B734', 'Boeing 737-400'),
       ('B735', 'Boeing 737-500'),
       ('B736', 'Boeing 737-600'),
       ('B737', 'Boeing 737-700'),
       ('B738', 'Boeing 737-800'),
       ('B739', 'Boeing 737-900'),
       ('B37M', 'Boeing 737 MAX 7'),
       ('B38M', 'Boeing 737 MAX 8'),
       ('B39M', 'Boeing 737 MAX 9'),
       ('B3XM', 'Boeing 737 MAX 10'),
       ('B741', 'Boeing 747-100'),
       ('B742', 'Boeing 747-200'),
       ('B743', 'Boeing 747-300'),
       ('B744', 'Boeing 747-400'),
       ('B748', 'Boeing 747-8'),
       ('N74S', 'Boeing 747SP'),
       ('B74R', 'Boeing 747SR'),
       ('B752', 'Boeing 757-200'),
       ('B753', 'Boeing 757-300'),
       ('B762', 'Boeing 767-200'),
       ('B763', 'Boeing 767-300'),
       ('B764', 'Boeing 767-400'),
       ('B772', 'Boeing 777-200/ER'),
       ('B77L', 'Boeing 777-200LR'),
       ('B773', 'Boeing 777-300'),
       ('B77W', 'Boeing 777-300ER'),
       ('B788', 'Boeing 787-8'),
       ('B789', 'Boeing 787-9'),
       ('B78X', 'Boeing 787-10'),
       ('ATP', 'British Aerospace ATP'),
       ('CRJ1', 'Canadair Regional Jet CRJ-100'),
       ('CRJ2', 'Canadair Regional Jet CRJ-200'),
       ('CRJ7', 'Canadair Regional Jet CRJ-550/700'),
       ('CRJ9', 'Canadair Regional Jet CRJ-900'),
       ('CRJX', 'Canadair Regional Jet CRJ-1000'),
       ('C172', 'Cessna 172'),
       ('C182', 'Cessna 182'),
       ('C206', 'Cessna 206'),
       ('C208', 'Cessna 208'),
       ('C208B', 'Cessna 208B'),
       ('C310', 'Cessna 310'),
       ('C414', 'Cessna 414'),
       ('C421', 'Cessna 421'),
       ('C525', 'Cessna 525'),
       ('C560', 'Cessna 560'),
       ('C650', 'Cessna 650'),
       ('C680', 'Cessna 680'),
       ('E120', 'Embraer EMB-120 Brasilia'),
       ('E135', 'Embraer ERJ-135'),
       ('E145', 'Embraer ERJ-145'),
       ('E170', 'Embraer ERJ-170'),
       ('E75S', 'Embraer E175 (short wing)'),
       ('E75L', 'Embraer E175 (long wing)'),
       ('EMB9', 'Embraer ERJ-190'),
       ('E290', 'Embraer E190 E2'),
       ('E295', 'Embraer E195 E2'),
       ('F100', 'Fokker 100'),
       ('AC68', 'Gulfstream/Rockwell (Aero) Commander'),
       ('AC90', 'Gulfstream/Rockwell (Aero) Turbo Commander');

ALTER TABLE "public"."flight"
    ADD COLUMN "aircraft_id" INTEGER;

UPDATE "public"."flight" f
SET aircraft_id = a.id FROM aircraft a
WHERE upper (trim (f.aircraft)) = a.icao
  AND f.aircraft_id IS NULL;

ALTER TABLE "public"."flight"
    ADD CONSTRAINT "flight_aircraft_id_fkey" FOREIGN KEY ("aircraft_id") REFERENCES "public"."aircraft" ("id") ON DELETE SET NULL ON UPDATE CASCADE;

ALTER TABLE "public"."flight" DROP COLUMN "aircraft";
